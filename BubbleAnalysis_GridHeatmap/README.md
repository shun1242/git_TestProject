# 気泡データ解析プログラム

このプログラムは、CSVファイルから気泡データを読み込み、観察領域内の気泡をグリッドごとに集計し、結果をExcelファイルに出力します。出力されたExcelファイルには、集計結果、全体の統計情報、および3つのヒートマップ（気泡数、平均直径、体積の合計）が含まれます。

## 特徴

- **動的な粒子数への対応**：粒子数が変動してもデータを正しく処理します。
- **観察領域の設定**：ユーザーが指定した観察領域内の気泡のみを解析します。
- **直径と体積の計算**：面積から直径を計算し、直径に応じて体積を計算します。
  - **直径が100µmを超える場合**：高さ100µmの円柱として体積を計算。
  - **直径が100µm以下の場合**：球として体積を計算。
- **グリッドごとの集計**：Y方向を10分割し、1マスの高さを(y_max - y_min)/10とします。その1マス辺長をもとに正方形マスを敷き詰めるようにX方向を分割します。X方向はfloor((x_max - x_min) / cell_size)個のセルを作成します。（切り捨てにより、X方向の端部に満たない領域は捨てられます）
- **ヒートマップの作成**：3つのメトリックについて、Excelの条件付き書式を使用した白黒のヒートマップを作成します。
  - **X_bin**：右から左に0～(X方向セル数-1)
  - **Y_bin**：下から上に0～9

## 必要なライブラリ

- Python 3.x
- pandas
- numpy
- openpyxl
- tkinter

# 使用方法
1.プログラムの実行
python BubbleAnalysis_GridHeatmap.py

2.CSVファイルの選択
プログラムを実行すると、ファイルダイアログが表示されます。解析したいCSVファイルを選択してください。

3.観察領域の座標を入力
観察領域のY座標の最小値と最大値を入力してください。
**注意: x,y座標はcsvの軸の取り方と揃えています。**
Y座標の最小値: （例）0
Y座標の最大値: （例）100000
X座標の最小値: （例）0
X座標の最大値: （例）100000

4.結果の確認
入力したCSVファイルと同じフォルダに、<元のファイル名>_result.xlsx が生成されます。
Excelファイルを開き、以下のシートを確認できます。
集計結果：グリッドごとの気泡数、平均直径、体積の合計
サマリー：全体の気泡数、平均直径、直径の標準偏差、最小・最大直径、体積の合計
ヒートマップ：気泡数、平均直径、体積についてのヒートマップ